<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Letto | Mobile Command</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- CodeMirror CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/theme/dracula.min.css">
    
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body class="min-h-screen bg-slate-900 font-['JetBrains_Mono'] text-slate-300">
    <div id="main-container" class="min-h-screen flex flex-col p-4 max-w-4xl mx-auto overflow-x-hidden">
        <div id="boot-loader" class="flex-1 flex items-center justify-center">
            <div class="text-emerald-500 animate-pulse text-[10px] tracking-[0.5em]">INITIALIZING...</div>
        </div>

        <div id="login-view" class="hidden flex-1 flex flex-col justify-center py-10 max-w-md mx-auto w-full">
            <div class="text-center mb-12">
                <span class="text-6xl block mb-4">üåø</span>
                <h1 class="text-4xl font-bold text-emerald-400 glow-text">Letto</h1>
            </div>
            <div class="bg-slate-800/40 p-6 rounded-[2.5rem] border border-slate-700/50 backdrop-blur-xl">
                <input type="tel" id="token-input" maxlength="6" placeholder="SYNC CODE" class="w-full bg-slate-900 border border-slate-600 rounded-2xl py-5 text-center text-3xl tracking-[0.3em] focus:outline-none focus:border-emerald-500 mb-5 text-white">
                <button onclick="handleLogin()" id="login-btn" class="w-full bg-emerald-600 active:scale-[0.98] transition-all py-5 rounded-2xl font-bold text-lg">IDENTIFY</button>
            </div>
        </div>

        <div id="dashboard-view" class="hidden flex-1 flex flex-col pt-2">
            <header class="flex justify-between items-center mb-6">
                <h1 class="text-3xl font-bold text-white tracking-tighter glow-text">Letto üåø</h1>
                <div class="flex items-center gap-4">
                    <button onclick="downloadBackup()" id="backup-btn" class="bg-emerald-600/20 text-emerald-400 border border-emerald-500/30 px-3 py-1.5 rounded-xl text-[10px] font-bold uppercase tracking-widest hover:bg-emerald-600/40 transition-all flex items-center gap-2">
                        <span>üì¶</span> <span class="hidden sm:inline">Backup</span>
                    </button>
                    <div id="header-uptime" class="text-[12px] text-slate-400 font-bold uppercase tracking-widest hidden md:block">UPTIME: <span id="stat-uptime" class="text-emerald-400">--h --m</span></div>
                    <button onclick="updateStats(true)" class="w-8 h-8 bg-slate-800/40 rounded-lg flex items-center justify-center border border-white/5 shadow-xl hover:bg-emerald-900/20 active:scale-95 transition-all text-xs">üîÑ</button>
                    <button onclick="logout()" class="text-[12px] text-slate-500 hover:text-red-400/60 uppercase tracking-[0.2em] font-bold transition-all border border-slate-800 px-3 py-1 rounded-lg">Exit</button>
                </div>
            </header>

            <nav class="border-b border-white/5 pb-6 mb-6">
                <div class="flex flex-wrap items-center justify-between gap-y-4 mb-6">
                    <div class="flex flex-wrap gap-x-6 gap-y-2" id="nav-links">
                        <button onclick="navigateTo('/')" id="tab-main" class="text-[14px] font-bold uppercase tracking-[0.2em] text-emerald-400 border-b-2 border-emerald-500 pb-1 transition-all">–ì–ª–∞–≤–Ω–∞—è</button>
                        <button onclick="navigateTo('/projects')" id="tab-projects" class="text-[14px] font-bold uppercase tracking-[0.2em] text-slate-400 hover:text-slate-200 transition-all">–ü—Ä–æ–µ–∫—Ç—ã</button>
                        <button onclick="navigateTo('/explorer')" id="tab-explorer" class="text-[14px] font-bold uppercase tracking-[0.2em] text-slate-400 hover:text-slate-200 transition-all">–§–∞–π–ª—ã</button>
                        <button onclick="navigateTo('/git')" id="tab-git" class="text-[14px] font-bold uppercase tracking-[0.2em] text-slate-400 hover:text-slate-200 transition-all">Git</button>
                    </div>
                    <div class="flex items-center text-[11px] font-bold uppercase tracking-widest bg-slate-800/40 px-3 py-2 rounded-xl border border-white/5 shrink-0" id="pulse-indicator">
                        <span class="text-emerald-500 mr-2 md:mr-3">PULSE</span>
                        <label class="relative inline-flex items-center cursor-pointer scale-90 mr-2 md:mr-3">
                            <input type="checkbox" id="refresh-toggle" class="sr-only peer" onchange="toggleAutoRefresh(this.checked)">
                            <div class="w-7 h-4 bg-slate-700 border border-slate-600 rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-slate-400 after:rounded-full after:h-2.5 after:w-2.5 after:transition-all peer-checked:after:bg-emerald-400 peer-checked:bg-emerald-900/40"></div>
                        </label>
                        <span class="text-slate-300">NEXT: <span id="sync-timer" class="text-emerald-400">20</span>s</span>
                    </div>
                </div>
                
                <div class="flex flex-wrap gap-x-8 gap-y-2 text-[13px] font-mono font-bold uppercase tracking-tight bg-white/5 p-3 rounded-2xl">
                    <span class="text-slate-400">CPU: <span id="stat-cpu" class="text-emerald-400">0%</span></span>
                    <span class="text-slate-400">RAM: <span id="stat-ram" class="text-emerald-400">0%</span></span>
                    <span class="text-slate-400">DISK: <span id="stat-disk" class="text-emerald-400">0%</span></span>
                    <div class="flex items-center gap-2">
                        <span class="text-slate-400">AI: <span id="ai-full-status" class="text-emerald-400">Loading...</span></span>
                        <button onclick="updateAiStatus(true)" id="ai-status-refresh" class="text-[10px] text-slate-600 hover:text-emerald-400 transition-all">ü©∫</button>
                    </div>
                </div>
            </nav>

            <div id="main-dashboard-content">
                <div class="stat-card rounded-3xl mb-4 overflow-hidden flex flex-col">
                    <div class="bg-white/5 px-4 py-2 flex justify-between items-center">
                        <span class="text-[8px] text-slate-400 uppercase font-bold tracking-widest text-left">Heartbeat Tasks</span>
                        <div id="hb-last-seen" class="text-[16px] text-emerald-500 font-bold bg-emerald-900/10 px-2 py-0.5 rounded-lg border border-emerald-500/20">Never</div>
                    </div>
                    <textarea id="heartbeat-editor" class="w-full bg-transparent p-4 min-h-[16rem] text-[10px] text-slate-300 focus:outline-none resize-none no-scrollbar" spellcheck="false"></textarea>
                    <div class="px-4 pb-4 flex justify-end">
                        <button onclick="saveHeartbeat()" class="text-[8px] bg-emerald-600/20 text-emerald-400 px-3 py-1.5 rounded-xl font-bold uppercase tracking-widest">Save Tasks</button>
                    </div>
                </div>

                <div class="stat-card rounded-3xl mb-4 overflow-hidden flex flex-col">
                    <div class="bg-white/5 px-4 py-2 flex justify-between items-center">
                        <span class="text-[8px] text-slate-400 uppercase font-bold tracking-widest text-left">Cron Manager</span>
                        <div id="cron-count" class="text-[10px] font-bold text-emerald-400">0</div>
                    </div>
                    <div id="cron-list" class="px-4 py-1 text-left max-h-48 overflow-y-auto no-scrollbar">
                        <div class="py-4 text-center text-[9px] text-slate-600 italic">No scheduled tasks found</div>
                    </div>
                </div>

                <div class="stat-card rounded-3xl mb-4 overflow-hidden">
                    <div class="bg-white/5 px-4 py-2 flex justify-between items-center">
                        <span class="text-[8px] text-slate-400 uppercase font-bold tracking-widest">Active Agents</span>
                        <span id="stat-agents-count" class="text-[10px] font-bold text-emerald-400">0</span>
                    </div>
                    <div id="agents-list" class="px-4 py-1 text-left min-h-[24rem] overflow-y-auto no-scrollbar"></div>
                </div>
            </div>

            <!-- Workspace Explorer Section -->
            <div id="explorer-view-content" class="hidden flex-1 flex flex-col pt-2 pb-10">
                <div class="stat-card rounded-3xl mb-4 overflow-hidden flex-1 flex flex-col">
                    <div class="bg-white/5 px-6 py-4 flex justify-between items-center border-b border-white/5">
                        <span class="text-[10px] text-slate-400 font-bold uppercase tracking-[0.2em]">Project Workspace</span>
                        <div class="flex gap-4">
                            <button onclick="toggleAllDirs(true, 'files-tree')" class="text-[10px] text-emerald-500/60 font-bold uppercase hover:text-emerald-400 transition-all">Expand</button>
                            <button onclick="toggleAllDirs(false, 'files-tree')" class="text-[10px] text-slate-600 font-bold uppercase hover:text-slate-200 transition-all">Collapse</button>
                        </div>
                    </div>
                    <div id="files-tree" class="flex-1 px-6 py-4 text-left overflow-y-auto no-scrollbar text-[14px] font-mono leading-relaxed min-h-[16rem]">
                        <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –¥–µ—Ä–µ–≤–æ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞ -->
                    </div>
                </div>

                <div class="stat-card rounded-3xl mb-4 overflow-hidden flex flex-col bg-slate-900/50 border-emerald-500/10">
                    <div class="bg-emerald-500/5 px-6 py-4 flex justify-between items-center border-b border-emerald-500/10">
                        <span class="text-[10px] text-emerald-500/60 font-bold uppercase tracking-[0.2em]">OpenClaw System Configs</span>
                    </div>
                    <div id="system-configs-list" class="px-6 py-4 text-left overflow-y-auto no-scrollbar text-[14px] font-mono leading-relaxed">
                        <!-- –ü–ª–æ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥–æ–≤ -->
                    </div>
                </div>
            </div>

            <div id="projects-view-content" class="hidden flex-1 flex flex-col pt-4 pb-10">
                <div class="bg-slate-800/40 p-8 rounded-[2.5rem] border border-slate-700/50 text-center mb-6">
                    <span class="text-4xl block mb-4">üöÄ</span>
                    <h2 class="text-xl font-bold text-white mb-2">–û–±–∑–æ—Ä –ü—Ä–æ–µ–∫—Ç–æ–≤</h2>
                    <p class="text-[10px] text-slate-500 uppercase tracking-widest leading-relaxed text-center">
                        –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–≤–æ–∏–º–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º–∏
                    </p>
                </div>
                
                <div id="projects-list" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- –°—é–¥–∞ –≥—Ä—É–∑—è—Ç—Å—è –∫–∞—Ä—Ç–æ—á–∫–∏ -->
                </div>
            </div>

            <!-- Git History Section -->
            <div id="git-view-content" class="hidden flex-1 flex flex-col">
                <div class="stat-card rounded-3xl mb-4 overflow-hidden text-left flex-1 flex flex-col">
                    <div class="bg-white/5 px-6 py-4 flex justify-between items-center border-b border-white/5">
                        <div class="flex flex-col gap-1">
                            <span class="text-[10px] text-slate-400 uppercase font-bold tracking-[0.2em]">Git Commits History</span>
                            <span id="git-page-branch" class="text-[10px] text-emerald-400 font-mono font-bold bg-emerald-900/20 px-3 py-1 rounded-lg border border-emerald-500/30 w-fit"></span>
                        </div>
                        <button id="git-sync-btn" onclick="syncGitDev()" class="bg-emerald-600/20 text-emerald-400 border border-emerald-500/30 px-4 py-2 rounded-xl text-[10px] font-bold uppercase tracking-widest hover:bg-emerald-600/40 transition-all">
                            Sync to Dev
                        </button>
                    </div>
                    <div id="git-full-list" class="flex-1 px-6 py-4 overflow-y-auto no-scrollbar">
                        <!-- –°—é–¥–∞ –±—É–¥–µ–º –≥—Ä—É–∑–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–æ–º–º–∏—Ç–æ–≤ -->
                    </div>
                </div>
            </div>

            <div id="file-viewer-content" class="hidden flex-1 flex flex-col">
                <div class="flex items-center justify-between mb-4">
                    <button onclick="closeFileViewer()" class="text-[10px] bg-slate-800 text-slate-300 px-4 py-2 rounded-xl font-bold uppercase tracking-widest border border-white/5 shadow-xl active:scale-95 transition-all">‚Üê Back</button>
                    <button id="translate-btn" onclick="toggleTranslation()" class="hidden text-[10px] bg-emerald-600/20 text-emerald-400 px-4 py-2 rounded-xl font-bold uppercase tracking-widest border border-emerald-500/30 shadow-xl active:scale-95 transition-all">Translate</button>
                    <div id="viewer-filename" class="text-[12px] text-emerald-400 font-bold font-mono truncate max-w-[30%]">file.py</div>
                </div>
                <div class="flex-1 bg-slate-900 border border-slate-800 rounded-3xl overflow-hidden min-h-0 shadow-inner flex flex-col">
                    <div id="editor-container" class="flex-1 h-full"></div>
                </div>
                <div id="viewer-pagination" class="mt-4 flex justify-center items-center gap-4 hidden border-t border-white/5 pt-4">
                    <button id="page-prev" class="text-[10px] text-emerald-500 uppercase font-bold px-2 py-1">Prev</button>
                    <span id="page-info" class="text-[9px] text-slate-500">Page 1 of 1</span>
                    <button id="page-next" class="text-[10px] text-emerald-500 uppercase font-bold px-2 py-1">Next</button>
                </div>
            </div>
        </div>
    </div>

    <!-- CodeMirror Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/python/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/markdown/markdown.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/xml/xml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/htmlmixed/htmlmixed.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/css/css.min.js"></script>

    <script src="/static/js/app.js"></script>
</body>
</html>
